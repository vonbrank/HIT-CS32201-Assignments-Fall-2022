# 实验三测试环境说明

lab3文件夹为计算机组织与体系结构课程实验3-流水线CPU实验测试环境的目录
## 目录
```
├── lab_3
│   ├── lab_3.srcs                 所有用户编写的源码、仿真文件与约束文件，你在项目中创建的文件可以在这里找到
│   ├── lab3.data                  自动化测试所使用的trace文件的文件夹
│   │   ├── additional_cpu_trace1  附加测试1：用于对比验证的的trace文件
│   │   ├── additional_cpu_trace2  附加测试2：用于对比验证的的trace文件
│   │   ├── additional_data_data   附加测试：数据缓冲存储器的初始化文件
│   │   ├── additional_inst_data1  附加测试1：指令缓冲存储器的初始化文件
│   │   ├── additional_inst_data2  附加测试2：指令缓冲存储器的初始化文件
│   │   ├── additional_reg_data    附加测试：寄存器组的初始化文件
│   │   ├── base_cpu_trace         基础测试：用于对比验证的的trace文件
│   │   ├── base_data_data         基础测试：数据缓冲存储器的初始化文件
│   │   ├── base_inst_data         基础测试：指令缓冲存储器的初始化文件
│   │   ├── base_reg_data          基础测试：寄存器组的初始化文件
│   └── lab_3.xpr                  实验所用的项目，直接双击即可打开完整的实验 Vivado 工程
└── readme.md                      本文档
```

## 测试样例

### 基础测试

```
寄存器：  全0

数据存储器：
for i in range(0, 84, 4):
    Mem[i] = i >> 2

指令缓冲：
0x0000:  8C 01 00 04    lw  $1, 4($0)       // $1 <= 0x1
0x0004:  8C 02 00 08    lw  $2, 8($0)       // $2 <= 0x2
0x0008:  8C 03 00 0C    lw  $3, 0xc($0)     // $3 <= 0x3
0x000c:  8C 04 00 10    lw  $4, 0x10($0)    // $4 <= 0x4
0x0010:  8C 05 00 14    lw  $5, 0x14($0)    // $5 <= 0x5
0x0014:  00 22 20 20    add $4, $1, $2      // $4 <= 0x3
0x0018:  00 23 28 20    add $5, $1, $3      // $5 <= 0x4
0x001c:  8C 01 00 30    lw  $1, 0x30($0)    // $1 <= 0xc
0x0020:  00 00 00 00    nop
0x0024:  00 00 00 00    nop
0x0028:  00 00 00 00    nop
0x002c:  8C 22 00 04    lw  $2, 4($1)       // $2 <= 0x4
0x0030:  8C 23 00 08    lw  $3, 8($1)       // $3 <= 0x5
0x0034:  00 00 00 00    nop
0x0038:  00 00 00 00    nop
0x003c:  00 00 00 00    nop
0x0040:  00 64 28 20    add $5, $3, $4      // $5 <= 0x8
0x0044:  00 62 30 20    add $6, $3, $2      // $6 <= 0x9
0x0048:  00 00 00 00    nop
0x004c:  00 00 00 00    nop
0x0050:  00 00 00 00    nop
0x0054:  00 C5 48 22    sub $9,  $6, $5     // $9  <= 0x1
0x0058:  00 C3 50 22    sub $10, $6, $3     // $10 <= 0x4
0x005c:  00 00 00 00    nop
0x0060:  00 00 00 00    nop
0x0064:  00 00 00 00    nop
0x0068:  8D 4B 00 00    lw  $11, ($10)      // $11 <= 0x1
0x006c:  8D 4C 00 08    lw  $12, 8($10)     // $12 <= 0x3
```

trace:
|  pc  | addr |  data  |
00000000  01   00000001
00000004  02   00000002
00000008  03   00000003
0000000c  04   00000004
00000010  05   00000005
00000014  04   00000003
00000018  05   00000004
0000001c  01   0000000c
0000002c  02   00000004
00000030  03   00000005
00000040  05   00000008
00000044  06   00000009
00000054  09   00000001
00000058  0a   00000004
00000068  0b   00000001
0000006c  0c   00000003


### 附加测试1

```
寄存器：全0

数据存储器：
for i in range(0, 124, 4):
    Mem[i] = i

指令缓冲：
0x0000:  8C 0A 00 04    lw   $10, 4($0)         // $10 <= 0x4
0x0004:  8D 4C 00 04    lw   $12, 4($10)        // $12 <= 0x8
0x0008:  01 8C 70 20    add  $14, $12, $12      // $14 <= 0x10
0x000c:  8D CA 00 08    lw   $10, 8($14)        // $10 <= 0x18
0x0010:  8D CC 00 0C    lw   $12, 0xc($14)      // $12 <= 0x1c
0x0014:  01 8A 70 20    add  $14, $12, $10      // $14 <= 0x34
0x0018:  8D CA 00 0C    lw   $10, 0xc($14)      // $10 <= 0x40
0x001c:  8D 8C 00 0C    lw   $12, 0xc($12)      // $12 <= 0x28
0x0020:  01 4C 70 20    add  $14, $10, $12      // $14 <= 0x68
0x0024:  8D 8A 00 10    lw   $10, 0x10($12)     // $10 <= 0x38
0x0028:  8D CC 00 10    lw   $12, 0x10($14)     // $12 <= 0x78
0x002c:  01 4A 70 20    add  $14, $10, $10      // $14 <= 0x70
0x0030:  01 CA 78 20    add  $15, $14, $10      // $15 <= 0xa8
0x0034:  01 E0 90 20    add  $18, $15, $0       // $18 <= 0xa8
0x0038:  02 52 78 20    add  $15, $18, $18      // $15 <= 0x150
0x003c:  01 CC 78 20    add  $15, $14, $12      // $15 <= 0xe8
0x0040:  01 EC 90 20    add  $18, $15, $12      // $18 <= 0x160
0x0044:  02 4F 78 20    add  $15, $18, $15      // $15 <= 0x248
0x0048:  01 40 80 20    add  $16, $10, $0       // $16 <= 0x38
0x004c:  02 0A 90 20    add  $18, $16, $10      // $18 <= 0x70
0x0050:  02 00 90 20    add  $18, $16, $0       // $18 <= 0x38
0x0054:  00 0C 78 20    add  $15, $0,  $12      // $15 <= 0x78
0x0058:  01 F2 A0 20    add  $20, $15, $18      // $20 <= 0xb0
0x005c:  02 8F 90 20    add  $18, $20, $15      // $18 <= 0x128
0x0060:  8E 0A 00 04    lw   $10, 4($16)        // $10 <= 0x3c
0x0064:  8D 4C FF FC    lw   $12, -4($10)       // $12 <= 0x38
0x0068:  01 80 98 0A    movz $19, $12, $0       // $19 <= 0x38
0x006c:  8E 6A 00 04    lw   $10, 4($19)        // $10 <= 0x3c
0x0070:  8D 4C 00 08    lw   $12, 8($10)        // $12 <= 0x44
0x0074:  01 8A 98 0A    movz $19, $12, $10      // 不写回
0x0078:  02 10 78 22    sub  $15, $16, $16      // $15 <= 0x0
0x007c:  02 94 90 20    add  $18, $20, $20      // $18 <= 0x160
0x0080:  02 4F 98 0A    movz $19, $18, $15      // $19 <= 0x160
0x0084:  02 0F 78 20    add  $15, $16, $15      // $15 <= 0x38
0x0088:  02 94 90 20    add  $18, $20, $20      // $18 <= 0x160
0x008c:  02 4F 98 0A    movz $19, $18, $15      // 不写回
0x0090:  00 00 88 0A    movz $17, $0,  $0       // $17 <= 0x0
0x0094:  02 32 A0 0A    movz $20, $17, $18      // 不写回
0x0098:  02 91 98 0A    movz $19, $20, $17      // $19 <= 0xb0
```

trace:
|  pc  | addr |  data  |
00000000  0a   00000004
00000004  0c   00000008
00000008  0e   00000010
0000000c  0a   00000018
00000010  0c   0000001c
00000014  0e   00000034
00000018  0a   00000040
0000001c  0c   00000028
00000020  0e   00000068
00000024  0a   00000038
00000028  0c   00000078
0000002c  0e   00000070
00000030  0f   000000a8
00000034  12   000000a8
00000038  0f   00000150
0000003c  0f   000000e8
00000040  12   00000160
00000044  0f   00000248
00000048  10   00000038
0000004c  12   00000070
00000050  12   00000038
00000054  0f   00000078
00000058  14   000000b0
0000005c  12   00000128
00000060  0a   0000003c
00000064  0c   00000038
00000068  13   00000038
0000006c  0a   0000003c
00000070  0c   00000044
00000078  0f   00000000
0000007c  12   00000160
00000080  13   00000160
00000084  0f   00000038
00000088  12   00000160
00000090  11   00000000
00000098  13   000000b0


### 附加测试2
```
寄存器：全0

数据存储器：
for i in range(0, 124, 4):
    Mem[i] = i

指令缓冲：
0x0000:  8D 6A 00 04    lw   $10, 4($11)         // $10 <= 0x04
0x0004:  01 4A 60 20    add  $12, $10, $10       // $12 <= 0x08
0x0008:  01 8C 78 20    add  $15, $12, $12       // $15 <= 0x10
0x000c:  8D 6A 00 08    lw   $10, 8($11)         // $10 <= 0x08
0x0010:  01 4A 60 20    add  $12, $10, $10       // $12 <= 0x10
0x0014:  01 8A 78 20    add  $15, $12, $10       // $15 <= 0x18
0x0018:  8D 6A 00 0C    lw   $10, 0xc($11)       // $10 <= 0x0c
0x001c:  01 4A 60 20    add  $12, $10, $10       // $12 <= 0x18
0x0020:  01 4C 78 20    add  $15, $10, $12       // $15 <= 0x24
0x0024:  8D 6A 00 10    lw   $10, 0x10($11)      // $10 <= 0x10
0x0028:  01 4A 60 20    add  $12, $10, $10       // $12 <= 0x20
0x002c:  01 4A 78 20    add  $15, $10, $10       // $15 <= 0x20
0x0030:  02 32 80 20    add  $16, $17, $18       // $16 <= 0x00
0x0034:  8E 93 00 04    lw   $19, 4($20)         // $19 <= 0x04
0x0038:  02 73 50 20    add  $10, $19, $19       // $10 <= 0x08
0x003c:  02 32 80 20    add  $16, $17, $18       // $16 <= 0x00
0x0040:  8E 93 00 08    lw   $19, 8($20)         // $19 <= 0x08
0x0044:  02 70 50 20    add  $10, $19, $16       // $10 <= 0x08
0x0048:  02 32 80 20    add  $16, $17, $18       // $16 <= 0x00
0x004c:  8E 93 00 0C    lw   $19, 0xc($20)       // $19 <= 0x0c
0x0050:  02 13 50 20    add  $10, $16, $19       // $10 <= 0x0c
0x0054:  02 32 80 20    add  $16, $17, $18       // $16 <= 0x00
0x0058:  8E 93 00 10    lw   $19, 0x10($20)      // $19 <= 0x10
0x005c:  02 10 50 20    add  $10, $16, $16       // $10 <= 0x00
0x0060:  01 60 50 0A    movz $10, $11, $0        // $10 <= 0x00
0x0064:  8D 53 00 04    lw   $19, 4($10)         // $19 <= 0x04
0x0068:  01 53 60 20    add  $12, $10, $19       // $12 <= 0x04
0x006c:  01 6B 60 20    add  $12, $11, $11       // $12 <= 0x00
0x0070:  8D 73 00 08    lw   $19, 8($11)         // $19 <= 0x08
0x0074:  02 60 50 0A    movz $10, $19, $0        // $10 <= 0x08
```

trace:
|  pc  | addr |  data  |
00000000  0a   00000004
00000004  0c   00000008
00000008  0f   00000010
0000000c  0a   00000008
00000010  0c   00000010
00000014  0f   00000018
00000018  0a   0000000c
0000001c  0c   00000018
00000020  0f   00000024
00000024  0a   00000010
00000028  0c   00000020
0000002c  0f   00000020
00000030  10   00000000
00000034  13   00000004
00000038  0a   00000008
0000003c  10   00000000
00000040  13   00000008
00000044  0a   00000008
00000048  10   00000000
0000004c  13   0000000c
00000050  0a   0000000c
00000054  10   00000000
00000058  13   00000010
0000005c  0a   00000000
00000060  0a   00000000
00000064  13   00000004
00000068  0c   00000004
0000006c  0c   00000000
00000070  13   00000008
00000074  0a   00000008

